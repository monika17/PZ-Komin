/*!
 * Modernizr v2.5.3
 * www.modernizr.com
 *
 * Copyright (c) Faruk Ates, Paul Irish, Alex Sexton
 * Available under the BSD and MIT licenses: www.modernizr.com/license/
 */
function loadTinyMCE(n,t,i,r,u,f,e){var h,c,s,o,a,l;if(n=n||"en-us",h="",c="",typeof i!="undefined"&&i!=null)for(s=i.split("|"),o=0;o<s.length;o++)h+=","+s[o],c+=",|,"+s[o];tinyMCE.editContainerHandler=function(n,t){for(var i=n.selection.getNode(),r,f,u;i!=null&&(!i.className||!i.className.match(/\bpluginHolder\b/))&&(!i.className||!i.className.match(/\bpluginEditHolder\b/));)i.className&&i.className.match(/\b(pluginEditHolderLink|pluginRemoveHolderLink)\b/)&&(r=i),i=i.parentNode;i!=null&&(i.className.match(/\bpluginHolder\b/)||i.className.match(/\bpluginEditHolder\b/))&&n.windowManager.count===0&&(f=i.getAttribute("pluginCommand"),r?(n.selection.select(i),r.className.match(/\bpluginEditHolderLink\b/)?n.execCommand(f,!1,null):r.className.match(/\bpluginRemoveHolderLink\b/)&&tinyMCE.DOM.remove(i.parentNode)):(u=$.Event(t),u.preventDefault(),u.stopPropagation()))},tinyMCE.init({mode:"specific_textareas",editor_selector:f!=null?f:"richText",theme:"advanced",skin:"galleries",convert_urls:!1,language:n.substr(0,2),readonly:e===!0?!0:!1,plugins:"safari,spellchecker,pagebreak,style,layer,table,advhr,advlink,iespell,inlinepopups,insertdatetime,preview,searchreplace,contextmenu,paste,directionality,noneditable,visualchars,nonbreaking,xhtmlxtras,template,fullscreen"+h,theme_advanced_buttons1:"cut,copy,paste,|,undo,redo,|,justifyleft,justifycenter,justifyright,justifyfull,|,numlist,bullist,|,outdent,indent,|,link,unlink,|,fullscreen,code",theme_advanced_buttons2:"formatselect,fontsizeselect,|,backcolor,forecolor,|,bold,italic,underline"+c,theme_advanced_buttons3:"",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",handle_event_callback:t,extended_valid_elements:"style[type],div[align<center?justify?left?right|class|dir<ltr?rtl|id|lang|onclick|ondblclick|onkeydown|onkeypress|onkeyup|onmousedown|onmousemove|onmouseout|onmouseover|onmouseup|style|title|pluginCommand]",locale:n,oninit:function(){if(typeof r!="undefined"&&r!=null&&r(),typeof tinyMCEGlobalInitFunctions!="undefined"&&tinyMCEGlobalInitFunctions!=null)for(var n=0;n<tinyMCEGlobalInitFunctions.length;n++)tinyMCEGlobalInitFunctions[n]()},setup:function(n){n.onInit.add(function(n){n.isInitialized||($(n.getContentAreaContainer()).is(":visible")&&n.execCommand("RespectVisibilityInDesign",!0,null),n.translate=a,n.getLang=l,n.isInitialized=!0)});var t=!1;n.onNodeChange.add(function(n,i,r){var e,o;if(t){if(tinyMCE.settings.fullscreen_is_enabled){if(tinyMCE.settings.fullscreen_editor_id===n.id)return;if(tinyMCE.settings.full_screen_is_closing)return}for(e=r;e!=null&&(!e.className||!e.className.match(/\bpluginHolder\b/));)e=e.parentNode;e!=null&&e.className.match(/\bpluginHolder\b/)&&n.windowManager.count===0&&(o=e.getAttribute("pluginCommand"),n.selection.select(e),n.execCommand(o,!1,null))}else n.isInitialized&&(t=!0)}),n.onBeforeExecCommand.add(function(){}),n.onSetContent.add(function(){typeof u=="function"&&u!=null&&u()}),n.onClick.add(function(n,t){tinyMCE.editContainerHandler(n,t)}),n.onKeyDown.add(function(n,t){tinyMCE.editContainerHandler(n,t)}),n.onKeyUp.add(function(){typeof u=="function"&&u!=null&&u()}),n.onChange.add(function(){typeof u=="function"&&u!=null&&u()}),n.onActivate.add(function(){typeof u=="function"&&u!=null&&u()}),n.onClick.add(function(){typeof u=="function"&&u!=null&&u()})}}),a=function(n){var i=this.settings.language||"en",t=tinymce.i18n;return n?t[i+"."+n]||n.replace(/\{\#([^\}]+)\}/g,function(n,r){return t[i+"."+r]||t["en."+r]||"{#"+r+"}"}):""},l=function(n,t){return tinymce.i18n[(this.settings.language||"en")+"."+n]||tinymce.i18n["en."+n]||(tinymce.is(t)?t:"{#"+n+"}")}}function getCleanDescription(n){var t=tinyMCEStripElementContent(n).text();return t&&(t=t.replace(/[\s\u00A0]/g,"")),t}function setupVsixIdBox(n,t,i){!i&&($("input[name='"+n+"'][value='10.0']").get(0).checked||$("input[name='"+n+"'][value='11.0']").get(0).checked||$("input[name='"+n+"'][value='12.0']").get(0).checked)&&$("#"+t).show(),$("input[name='"+n+"'][value='10.0']").click(function(){var i=!1;$("input[name='"+n+"'][value^='1']").each(function(){i|=this.checked}),i?$("#"+t).show():$("#"+t).hide()}),$("input[name='"+n+"'][value='11.0']").click(function(){var i=!1;$("input[name='"+n+"'][value^='1']").each(function(){i|=this.checked}),i?$("#"+t).show():$("#"+t).hide()}),$("input[name='"+n+"'][value='12.0']").click(function(){var i=!1;$("input[name='"+n+"'][value^='1']").each(function(){i|=this.checked}),i?$("#"+t).show():$("#"+t).hide()})}function setupSupportedVSEditionsBox(n,t,i,r){i||$("input[name='"+n+"'][value='"+r+"']").get(0).checked?$("#"+t).show():$("#"+t).hide(),$("input[name='"+n+"'][value='"+r+"']").click(function(){this.checked?$("#"+t).show():$("#"+t).hide()})}function setCheckBoxState(n,t,i){$("#"+n+" input").each(function(){if(i!=null&&$(this).attr("checked",i),t!=null)if(t){var r=$(this).clone();r.attr("id",r.attr("id")+"_clone"),i!=null&&r.attr("checked",i),r.attr("disabled",t),$(this).after(r),$(this).hide()}else $(this).attr("disabled",t)})}function attachSortHandler(n,t,i){var u="#"+n,r="#"+t;$(u).change(function(){var f=$(this).val(),e=i>0?"&":"?",u=$(r).attr("href")+e+"sortBy="+f;$(r).attr("href",u),$.browser.msie?document.getElementById(t).click():window.location=u})}function attachLogoTooltipHandler(){$(".contributionLogo").each(function(){$(this).hover(function(){var n=$(this).children(".contributionLogoTip");n&&(n.css("top","20px"),n.css("left","0px"),n.show())},function(){var n=$(this).children(".contributionLogoTip");n&&n.hide()})})}function attachCustomLogoHandler(){$(".customcontribution").each(function(){$(this).hover(function(){var n=$(this).children(".customcontributionLogoTip");n&&(n.css("top","15px"),n.css("left","0px"),n.show())},function(){var n=$(this).children(".customcontributionLogoTip");n&&n.hide()})})}function createFileManager(n,t,i,r,u,f,e,o,s,h){function c(){this.baseInit(n,t,i,r,u,f,e,o,h),this.loadFiles(s)}return fileManagerMethods.apply(c.prototype),new c}function createLocalizationFileManager(n,t,i,r,u,f,e,o){function s(){this.init(o),this.baseInit(n,t,i,r,u,f,e),this.loadFiles(o)}return fileManagerMethods.apply(s.prototype),localizationManagerMethods.apply(s.prototype),new s}var tinyMCEGlobalInitFunctions,tinyMCEStripElementContent,Galleries,StreamEvents,fileManagerMethods,localizationManagerMethods;window.Modernizr=function(n,t,i){function l(n){c.cssText=n}function pt(n,t){return l(a.join(n+";")+(t||""))}function h(n,t){return typeof n===t}function y(n,t){return!!~(""+n).indexOf(t)}function ft(n,t){for(var r in n)if(c[n[r]]!==i)return t=="pfx"?n[r]:!0;return!1}function yt(n,t,r){var f,u;for(f in n)if(u=t[n[f]],u!==i)return r===!1?n[f]:h(u,"function")?u.bind(r||t):u;return!1}function e(n,t,i){var r=n.charAt(0).toUpperCase()+n.substr(1),u=(n+" "+k.join(r+" ")+r).split(" ");return h(t,"string")||h(t,"undefined")?ft(u,t):(u=(n+" "+st.join(r+" ")+r).split(" "),yt(u,t,i))}function lt(){u.input=function(i){for(var r=0,u=i.length;r<u;r++)p[i[r]]=!!(i[r]in f);return p.list&&(p.list=!!(t.createElement("datalist")&&n.HTMLDataListElement)),p}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),u.inputtypes=function(n){for(var e=0,r,u,o,h=n.length;e<h;e++)f.setAttribute("type",u=n[e]),r=f.type!=="text",r&&(f.value=d,f.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(u)&&f.style.WebkitAppearance!==i?(s.appendChild(f),o=t.defaultView,r=o.getComputedStyle&&o.getComputedStyle(f,null).WebkitAppearance!=="textfield"&&f.offsetHeight!==0,s.removeChild(f)):/^(search|tel)$/.test(u)||(/^(url|email)$/.test(u)?r=f.checkValidity&&f.checkValidity()===!1:/^color$/.test(u)?(s.appendChild(f),s.offsetWidth,r=f.value!=d,s.removeChild(f)):r=f.value!=d)),ut[n[e]]=!!r;return ut}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var at="2.5.3",u={},bt=!0,s=t.documentElement,o="modernizr",et=t.createElement(o),c=et.style,f=t.createElement("input"),d=":)",ot={}.toString,a=" -webkit- -moz- -o- -ms- ".split(" "),ct="Webkit Moz O ms",k=ct.split(" "),st=ct.toLowerCase().split(" "),g={svg:"http://www.w3.org/2000/svg"},r={},ut={},p={},it=[],rt=it.slice,b,nt=function(n,i,r,u){var l,a,c,f=t.createElement("div"),h=t.body,e=h?h:t.createElement("body");if(parseInt(r,10))while(r--)c=t.createElement("div"),c.id=u?u[r]:o+(r+1),f.appendChild(c);return l=["&#173;","<style>",n,"</style>"].join(""),f.id=o,e.innerHTML+=l,e.appendChild(f),h||(e.style.background="",s.appendChild(e)),a=i(f,n),h?f.parentNode.removeChild(f):e.parentNode.removeChild(e),!!a},wt=function(t){var r=n.matchMedia||n.msMatchMedia,i;return r?r(t).matches:(nt("@media "+t+" { #"+o+" { position: absolute; } }",function(t){i=(n.getComputedStyle?getComputedStyle(t,null):t.currentStyle).position=="absolute"}),i)},ht=function(){function n(n,u){u=u||t.createElement(r[n]||"div"),n="on"+n;var f=n in u;return f||(u.setAttribute||(u=t.createElement("div")),u.setAttribute&&u.removeAttribute&&(u.setAttribute(n,""),f=h(u[n],"function"),h(u[n],"undefined")||(u[n]=i),u.removeAttribute(n))),u=null,f}var r={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return n}(),tt={}.hasOwnProperty,w,vt,v;w=h(tt,"undefined")||h(tt.call,"undefined")?function(n,t){return t in n&&h(n.constructor.prototype[t],"undefined")}:function(n,t){return tt.call(n,t)},Function.prototype.bind||(Function.prototype.bind=function(n){var t=this,r,i;if(typeof t!="function")throw new TypeError;return r=rt.call(arguments,1),i=function(){var f,e,u;return this instanceof i?(f=function(){},f.prototype=t.prototype,e=new f,u=t.apply(e,r.concat(rt.call(arguments))),Object(u)===u)?u:e:t.apply(n,r.concat(rt.call(arguments)))},i}),vt=function(i,r){var e=i.join(""),f=r.length;nt(e,function(i,r){for(var o=t.styleSheets[t.styleSheets.length-1],s=o?o.cssRules&&o.cssRules[0]?o.cssRules[0].cssText:o.cssText||"":"",h=i.childNodes,e={};f--;)e[h[f].id]=h[f];u.touch="ontouchstart"in n||n.DocumentTouch&&t instanceof DocumentTouch||(e.touch&&e.touch.offsetTop)===9,u.csstransforms3d=(e.csstransforms3d&&e.csstransforms3d.offsetLeft)===9&&e.csstransforms3d.offsetHeight===3,u.generatedcontent=(e.generatedcontent&&e.generatedcontent.offsetHeight)>=1,u.fontface=/src/i.test(s)&&s.indexOf(r.split(" ")[0])===0},f,r)}(['@font-face {font-family:"font";src:url("https://")}',["@media (",a.join("touch-enabled),("),o,")","{#touch{top:9px;position:absolute}}"].join(""),["@media (",a.join("transform-3d),("),o,")","{#csstransforms3d{left:9px;position:absolute;height:3px;}}"].join(""),['#generatedcontent:after{content:"',d,'";visibility:hidden}'].join("")],["fontface","touch","csstransforms3d","generatedcontent"]),r.flexbox=function(){return e("flexOrder")},r["flexbox-legacy"]=function(){return e("boxDirection")},r.canvas=function(){var n=t.createElement("canvas");return!!(n.getContext&&n.getContext("2d"))},r.canvastext=function(){return!!(u.canvas&&h(t.createElement("canvas").getContext("2d").fillText,"function"))},r.webgl=function(){try{var u=t.createElement("canvas"),r;r=!!(n.WebGLRenderingContext&&(u.getContext("experimental-webgl")||u.getContext("webgl"))),u=i}catch(f){r=!1}return r},r.touch=function(){return u.touch},r.geolocation=function(){return!!navigator.geolocation},r.postmessage=function(){return!!n.postMessage},r.websqldatabase=function(){return!!n.openDatabase},r.indexedDB=function(){return!!e("indexedDB",n)},r.hashchange=function(){return ht("hashchange",n)&&(t.documentMode===i||t.documentMode>7)},r.history=function(){return!!(n.history&&history.pushState)},r.draganddrop=function(){var n=t.createElement("div");return"draggable"in n||"ondragstart"in n&&"ondrop"in n},r.websockets=function(){for(var t=-1,i=k.length;++t<i;)if(n[k[t]+"WebSocket"])return!0;return"WebSocket"in n},r.rgba=function(){return l("background-color:rgba(150,255,150,.5)"),y(c.backgroundColor,"rgba")},r.hsla=function(){return l("background-color:hsla(120,40%,100%,.5)"),y(c.backgroundColor,"rgba")||y(c.backgroundColor,"hsla")},r.multiplebgs=function(){return l("background:url(https://),url(https://),red url(https://)"),/(url\s*\(.*?){3}/.test(c.background)},r.backgroundsize=function(){return e("backgroundSize")},r.borderimage=function(){return e("borderImage")},r.borderradius=function(){return e("borderRadius")},r.boxshadow=function(){return e("boxShadow")},r.textshadow=function(){return t.createElement("div").style.textShadow===""},r.opacity=function(){return pt("opacity:.55"),/^0.55$/.test(c.opacity)},r.cssanimations=function(){return e("animationName")},r.csscolumns=function(){return e("columnCount")},r.cssgradients=function(){var n="background-image:",i="gradient(linear,left top,right bottom,from(#9f9),to(white));",t="linear-gradient(left top,#9f9, white);";return l((n+"-webkit- ".split(" ").join(i+n)+a.join(t+n)).slice(0,-n.length)),y(c.backgroundImage,"gradient")},r.cssreflections=function(){return e("boxReflect")},r.csstransforms=function(){return!!e("transform")},r.csstransforms3d=function(){var n=!!e("perspective");return n&&"webkitPerspective"in s.style&&(n=u.csstransforms3d),n},r.csstransitions=function(){return e("transition")},r.fontface=function(){return u.fontface},r.generatedcontent=function(){return u.generatedcontent},r.video=function(){var i=t.createElement("video"),n=!1;try{(n=!!i.canPlayType)&&(n=new Boolean(n),n.ogg=i.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),n.h264=i.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),n.webm=i.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,""))}catch(r){}return n},r.audio=function(){var i=t.createElement("audio"),n=!1;try{(n=!!i.canPlayType)&&(n=new Boolean(n),n.ogg=i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),n.mp3=i.canPlayType("audio/mpeg;").replace(/^no$/,""),n.wav=i.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),n.m4a=(i.canPlayType("audio/x-m4a;")||i.canPlayType("audio/aac;")).replace(/^no$/,""))}catch(r){}return n},r.localstorage=function(){try{return localStorage.setItem(o,o),localStorage.removeItem(o),!0}catch(n){return!1}},r.sessionstorage=function(){try{return sessionStorage.setItem(o,o),sessionStorage.removeItem(o),!0}catch(n){return!1}},r.webworkers=function(){return!!n.Worker},r.applicationcache=function(){return!!n.applicationCache},r.svg=function(){return!!t.createElementNS&&!!t.createElementNS(g.svg,"svg").createSVGRect},r.inlinesvg=function(){var n=t.createElement("div");return n.innerHTML="<svg/>",(n.firstChild&&n.firstChild.namespaceURI)==g.svg},r.smil=function(){return!!t.createElementNS&&/SVGAnimate/.test(ot.call(t.createElementNS(g.svg,"animate")))},r.svgclippaths=function(){return!!t.createElementNS&&/SVGClipPath/.test(ot.call(t.createElementNS(g.svg,"clipPath")))};for(v in r)w(r,v)&&(b=v.toLowerCase(),u[b]=r[v](),it.push((u[b]?"":"no-")+b));u.input||lt(),u.addTest=function(n,t){if(typeof n=="object")for(var r in n)w(n,r)&&u.addTest(r,n[r]);else{if(n=n.toLowerCase(),u[n]!==i)return u;t=typeof t=="function"?t():t,s.className+=" "+(t?"":"no-")+n,u[n]=t}return u},l(""),et=f=null;
/*! HTML5 Shiv v3.4 | @afarkas @jdalton @jon_neal @rem | MIT/GPL2 Licensed */
return function(n,t){function h(n,t){var r=n.createElement("p"),i=n.getElementsByTagName("head")[0]||n.documentElement;return r.innerHTML="x<style>"+t+"</style>",i.insertBefore(r.lastChild,i.firstChild)}function c(){var n=i.elements;return typeof n=="string"?n.split(" "):n}function s(n){var r={},u=n.createElement,f=n.createDocumentFragment,t=f();n.createElement=function(n){var f=(r[n]||(r[n]=u(n))).cloneNode();return i.shivMethods&&f.canHaveChildren&&!o.test(n)?t.appendChild(f):f},n.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+c().join().replace(/\w+/g,function(n){return r[n]=u(n),t.createElement(n),'c("'+n+'")'})+");return n}")(i,t)}function u(n){var t;return n.documentShived?n:(i.shivCSS&&!e&&(t=!!h(n,"article,aside,details,figcaption,figure,footer,header,hgroup,nav,section{display:block}audio{display:none}canvas,video{display:inline-block;*display:inline;*zoom:1}[hidden]{display:none}audio[controls]{display:inline-block;*display:inline;*zoom:1}mark{background:#FF0;color:#000}")),f||(t=!s(n)),t&&(n.documentShived=t),n)}var r=n.html5||{},o=/^<|^(?:button|form|map|select|textarea)$/i,e,f,i;(function(){var n=t.createElement("a");n.innerHTML="<xyz></xyz>",e="hidden"in n,f=n.childNodes.length==1||function(){try{t.createElement("a")}catch(i){return!0}var n=t.createDocumentFragment();return typeof n.cloneNode=="undefined"||typeof n.createDocumentFragment=="undefined"||typeof n.createElement=="undefined"}()})(),i={elements:r.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:!(r.shivCSS===!1),shivMethods:!(r.shivMethods===!1),type:"default",shivDocument:u},n.html5=i,u(t)}(this,t),u._version=at,u._prefixes=a,u._domPrefixes=st,u._cssomPrefixes=k,u.mq=wt,u.hasEvent=ht,u.testProp=function(n){return ft([n])},u.testAllProps=e,u.testStyles=nt,u.prefixed=function(n,t,i){return t?e(n,t,i):e(n,"pfx")},s.className=s.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(bt?" js "+it.join(" "):""),u}(this,this.document),tinyMCEGlobalInitFunctions=[],tinyMCEStripElementContent=function(){return function(n){var t=$(n).clone().empty();return $(n).children().each(function(n,i){t.append($(i).clone())}),$(".hidden, .scriptcode, img",t).remove(),$("h1, h2, h3",t).each(function(){Galleries.tinyMCETemplate.checkHeader($(this).text())&&$(this).remove()}),t}}(),$(function(){jQuery.fn.createHiddenDiv=function(n){var i=this,t=$('<div id="'+n+'"></div>');return t.hide(),i.append(t),t},jQuery.fn.createProgressDiv=function(n,t){var r=this,i=$('<div id="'+n+'"></div>');return i.hide(),r.append(i),i.html('<div style="float: right; padding-top: 5px;"></div><img src="'+t+'" style="float: left; margin-right: 10px;" />'),i},jQuery.fn.impromptuWithContentReplace=function(n,t){var i="40%";$.prompt(n.html(),{top:i,buttons:{},prefix:t}),$("."+t+"message").replaceWith(n.show())},jQuery.fn.Tabify=function(n,t,i){function u(n){return $("#"+n.id.split("_")[0]+"_Content")}var f=this,e=this.map(function(){return u(this).get()}),r;this.click(function(){f.removeClass(n),$(this).addClass(n),e.hide(),u(this).show(),i&&i(this.id)}),t&&(r=$("#"+t+"_Tab"),r.data("pageLoad",!0),r.click(),r.data("pageLoad",!1))},jQuery.fn.resizeComplete=function(n){function r(){u()?(clearTimeout(f),n(),i=!1):(o=t.height(),e=t.width(),f=setTimeout(function(){r()},250))}function u(){var i=t.height(),n=t.width();return i===o&&n===e}function s(){i||u()||(i=!0,r())}var t=this,o=t.height(),e=t.width(),i=!1,f;$.browser.mozilla?t.resize(n):t.resize(s)},jQuery.fn.ToggleView=function(){function i(n){return $("."+n.id.split("_")[0]+"_NonDefault")}function r(n){return $("#"+n.id+"_All")}function u(n){return $("#"+n.id+"_Defaults")}var f=this,t=this.map(function(){return r(this).get()}),n=this.map(function(){return u(this).get()});t.click(function(){return n.show(),t.hide(),i(this).show(),!1}),n.click(function(){return n.hide(),t.show(),i(this).hide(),!1}),n.click()},jQuery.fn.WireTrackerForEvent=function(n,t,i,r,u){this.bind(n,function(){$().TrackEvent(t,i,r,u)})},jQuery.fn.TrackEvent=function(n,t,i,r){var u=n+(n.indexOf("?")>-1?"&":"?")+"Event="+escape(t)+"&Data="+escape(i)+"&Time="+ +new Date;$.ajax({type:"GET",url:u,async:r,timeout:500})},jQuery.fn.getJSONGalleries=function(n,t){$.getJSON(n,t,function(n,t){t==="success"&&$.each(n,function(n,t){$("#"+t.ElementId).html(t.Content)})})},jQuery.fn.watermark=function(n){var i=function(t){t.val()===""&&(t.val(n),t.addClass("watermark"))},r=function(t){t.val()===n&&(t.val(""),t.removeClass("watermark"))},t=$(this);this.focus(function(){r(t)}),this.blur(function(){i(t)}),this.change(function(){i(t)}),$(function(){i(t)})},jQuery.fn.trackCopy=function(n){var i=this[0],r=3,f=99,u=67,t=function(){var t=null;if(document.selection?t=document.selection.createRange().parentElement():window.getSelection()&&(t=window.getSelection().anchorNode),t){while(t!=null&&t!=i)t=t.parentNode;t==i&&n()}};$(document).mouseup(function(n){n.which==r&&t()}),$(document).keydown(function(n){n.ctrlKey&&(n.keyCode==f||n.keyCode==u)&&t()})},jQuery.fn.split=function(){var n={initialSize:265,paneSpacing:20,minLeftPaneWidth:265,minRightPaneWidth:400,splitter:'<div style="float: left;cursor: w-resize;"><div></div></div>',splitterCss:{width:"5px",background:"rgb(232, 232, 232)"},resizerCss:{height:"30px",border:"2px dotted rgb(0, 0, 0)"}},t=function(t){var c=0,h=0,e=!1,i=t?$().extend({},n,t):n,s=this,o=$("> div",this),r=$(o[0]).css({float:"left",width:i.initialSize+"px",overflow:"auto"}),l=$(o[1]).css({"margin-left":i.initialSize+i.paneSpacing+"px"}),f,u;this.mousedown(function(n){if(e)return n.preventDefault(),n.stopImmediatePropagation(),!1}),$(document).mousemove(function(n){if(e){var u=n.pageX-c,t=h+u;t<i.minLeftPaneWidth?t=i.minLeftPaneWidth:s.width()-t-i.paneSpacing<i.minRightPaneWidth&&(t=s.width()-i.minRightPaneWidth-i.paneSpacing),r.width(t),l.css("margin-left",t+i.paneSpacing)}}).mouseup(function(){e=!1}),f=$(i.splitter).height(r.css("height")?r.css("height"):r.height()).mousedown(function(n){c=n.pageX,h=r.width(),e=!0}).insertAfter(o[0]),typeof i.splitterCss=="string"?f.addClass(i.splitterCss):f.css(i.splitterCss),u=$("div",f),u.length>0&&(typeof i.resizerCss=="string"?u.addClass(i.resizerCss):u.css(i.resizerCss),u.css("margin-top",r.height()/2-u.height()/2+"px"))};return t.defaultOptions=n,t}(),jQuery.fn.addListFilter=function(){function f(n){t=n?$().extend({},u,n):u,i=this,h(),s()}function h(){var u=$("<div id='filterInputBox'></div>").insertBefore(i),r;$("<table class='filterBox'><tbody><tr><td class='stxtcell'></td><td id='filterImageCell'></td></tr></tbody></table><span id='spnNoMatch' style='display:none;margin-left:10px;'>"+t.noMatchMessage+"</span>").appendTo(u),r=$("td",u),n=$("<input id='filterInput' type='text' class='stxtinptpassive'>").appendTo(r[0]),$("<input id='filterImg' type='image' src='"+t.transGifUrl+"'>").appendTo(r[1]),n.val(t.watermark)}function s(){n.change(function(){r()}),n.keyup(function(){r()}),n.focus(function(){o()}),n.blur(function(){e()})}function r(){var u,r,f;$("#spnNoMatch").hide(),u=n.val().toLowerCase(),u.length==0||u==String(t.watermark).toLowerCase()?i.children().show():(i.children().hide(),r=$("input",i).filter(function(){return $(this).attr("data-tag").toLowerCase().indexOf(u)!=-1}),r.length==0?$("#spnNoMatch").show():(r.show(),r.next("label").show(),r.prev("br").show(),f=$(r.get(0)).prev("br"),f&&f.hide()))}function e(){n.val()==""&&n.val(t.watermark),n.removeClass("stxtinpt").addClass("stxtinptpassive"),r()}function o(){n.val(""),n.removeClass("stxtinptpassive").addClass("stxtinpt")}var u={watermark:"Search for Tags"},i,t,n;return f.defaultOptions=u,f}()}),Galleries={},Galleries.upload=function(){function i(n,t,i,r,u){function o(u){function f(){$("div.attachment[data-file="+u+"]",t).remove(),n.removeFileFromFileContainer(u)}return r&&r(u),i?$.ajax({url:i.replace(/\{:FileId:\}/g,u),data:{fileId:u},type:"delete",success:function(){f()}}):f(),!1}function f(i,r,u,f){if(n.addFileToFileContainer(u,f,i,r),f==="Attachment"){var h=s.replace(/\{:FileUrl:\}/g,r).replace(/\{:FileName:\}/g,i).replace(/\{:FileId:\}/g,u),e=$(h);e.find(".removeAttachment").click(function(){return o(u),!1}),e.appendTo(t)}}function h(){$.each(u,function(n,t){f(t.name,t.url,t.fileId,t.type)})}var s="<div class='attachment' data-file='{:FileId:}'> <div class='displayAttachment'><a href='{:FileUrl:}' title='{:FileName:}' target='_blank'>{:FileName:}</a></div><a href='#' class='removeAttachment'></a></div>",e={removeAttachment:o,addAttachment:f};return this.fileAttachmentManager=e,h(),e}function u(t,i,r,u,f,e){return n(t,i,null,"Tag","tag","addedTags",r,u,f,e)}function t(t,i,r,u,f,e){return n(t,i,r,"ProjectName","projectTitle","addedProjects",u,null,f,e)}function n(n,t,i,r,u,f,e,o,s,h){function a(){b.html(""),$.each(l,function(n,i){var u=i.value,r;t.indexOf("[indexer]")>-1&&(u=u.replace(/\[indexer\]/ig,"["+n+"]")),r=$(u),$("a",r).click(function(){l=jQuery.grep(l,function(n){return n.id!=i.id}),a()}),b.append(r)})}function p(n,r,f){var c="<div class='"+u+"'>",v="<input type='hidden' name='"+t+"' value = '"+n+"' />",y=i?"<input type='hidden' name='"+i+"' value = '"+f+"' />":"",o="<label>"+r+"</label>",s="<a>"+e.removeLink+"</a>",h="</div>";l.push({id:w,value:c+v+y+o+s+h}),w++,a()}function v(n,t){if(n!=e.watermark||t){k.children().remove();var i={};i[r]=n,$.post(s,i,function(n){n.IsError?n.ErrorMessage&&k.append("<span class='field-validation-error'>"+n.ErrorMessage+"</span>"):(c.val("").trigger("change").blur(),p(n.EncodedValue,n.DisplayString,n.EncodedDisplayString),a())})}}var y={addItem:null},l=[],w=0,c=$("input[type=text]",n),b=$("."+f,n),k=$(".errors",n);return h=h||[],o&&c.autocomplete(o,{tagMode:"single",enterKeyCallback:v,watermark:e.watermark}),c.next("a").click(function(){v($(this).prev("input").val())}),c.keydown(function(n){n.which!=13||n.isPropagationStopped()||(n.preventDefault(),n.stopPropagation(),c.next("a").click())}),$.each(h,function(){p(this.encodedValue,this.displayString,this.encodedDisplayString)}),y.addItem=v,y}var r=function(n){var u=$(n[0]),r=function(n){return $("input[name=files][data-type="+n+"]",u).map(function(){return this.value})},f=function(t){$("input[name=files][value="+t+"]",n).remove()},i=function(t,i,r,u){$("<input type='hidden' name='files' />").attr("value",t).attr("data-file",t).attr("data-type",i).attr("data-name",r||null).attr("data-url",u||null).appendTo(n)},t={getFilesFromContainer:r,removeFileFromFileContainer:f,addFileToFileContainer:i};return this.fileContainer=t,t};return{createFileContainer:r,createAttachmentManager:i,createTagger:u,createProjectList:t,createListInput:n}}(),Galleries.tinyMCETemplate=function(){function f(t,u,f){i=u;var e=function(){tinyMCE.activeEditor.isNotDirty=!0;var i=tinyMCE.activeEditor.getContent();if(i&&i.length!==0)n=!0;else{if(tinyMCE.activeEditor.id!=t)return;typeof f!="undefined"&&f!=null&&r(f,!0)}};tinyMCEGlobalInitFunctions.push(e)}function r(t,r,u){if(typeof tinyMCE!="undefined"&&tinyMCE!=null){if(!r&&(tinyMCE.activeEditor.isDirty()||n)){var f=tinyMCE.activeEditor.getContent();if(f&&f.length>0&&typeof u!="undefined"&&u!=null){u();return}}tinyMCE.activeEditor.setContent(i[t]),tinyMCE.activeEditor.isNotDirty=!0,n=!1}}function u(n){return t.length==0&&$.each(i,function(n,i){var r=$("<div></div");r.html(i),$("h1, h2, h3",r).each(function(){t.push($(this).text())})}),$.inArray(n,t)>-1}var i,t=[],n=!1;return{init:f,checkHeader:u,setTinyMCETemplate:r}}(),Galleries.SourceCodeBrowser=function(){function e(t){n=t,l(),h(),a(),c(),$(window).bind("popstate",o)}function l(){$(".sourceListTabs > div").addClass("languageTab"),t($(".sourceListTabs div:first"))}function a(){$(".langContent > .browserDir").each(function(){u(this)}),$(".languageNode").css("display","none")}function c(){var o=$("div#sourceItem").children('[class!="heading"]'),f,r,e,u;if(o.length>0){for(f=$(".sourceList a[data-fileid="+n.loadedFileId+"][data-pathid="+n.loadedPathId+"]"),r=f,r.children("div:first").addClass("sbsf");r&&r.length;)r=r.parent().prev(".browserDir"),s(r);e=$(f).parents(".langContent").attr("id").replace("_Content",""),t($("#"+e)),i(n.loadedFileId),window.history&&window.history.pushState&&(u={title:document.title,fileId:n.loadedFileId,pathId:n.loadedPathId},window.history.replaceState(u,null,document.location.href))}else window.history&&window.history.pushState&&(u={title:document.title},window.history.replaceState(u,null))}function h(){$(".browserDir").bind("click",this,function(){u(this)}),$(".browseFile").bind("click",this,function(t){t.preventDefault(),r(this,!0),Galleries.url.recordAdditionalPageView("SourceCode_File_"+$(this).data("pathid"),n.statisticsUrl?n.statisticsUrl:null)}),$(".languageTab").bind("click",this,function(){t(this)})}function i(n){function y(n){return n.length>0&&n[0].innerText?n[0].innerText:l(n)}var l=jQuery.text,r=$("div#sourceItem > div+div > pre"),e,i,s,h,o;if(r.length>0){r.parent().trackCopy(function(){f(n)}),jQuery.text=y;var c=$.trim(r.text().replace(/(\r(\n)?)|((\r)?\n)/ig,"\r\n")),a=!1,t=v(),u=c.split("\r\n");t&&t<=u.length+1&&(e=u[t-1],u[t-1]=e.replace(e,"(hts)"+e+"(hte)"),r.text(u.join("\r\n")),a=!0),r.chili(),a&&(i=$("div#sourceItem > div+div > pre"),s=i.html().replace("(hts)","<span id='scrollLine' class='linehighlight'>").replace("(hte)","</span>"),i.html("<pre>"+s+"</pre>"),$("body").hasClass("IE7")||$("body").hasClass("IE8")||$("body").hasClass("IE9")?document.getElementById("scrollLine").scrollIntoView():(h=i.css("line-height").replace("px",""),i.parent().scrollTop((t-5)*h))),jQuery.text=l,window.clipboardData&&clipboardData.setData&&(o=$("div#sourceItem a.copyCode"),o.click(function(){return f(n),clipboardData.setData("Text",c),!1}),o.show())}}function v(){var r="lineno",i=document.location.search.substring(1),t={},n;return i&&i.replace(/([^?=&]+)=([^&]*)?/g,function(n,i,r){t[i]=r}),n=parseInt(t[r],10),!isNaN(n)&&n>0?n:void 0}function f(n){window.gTracker&&window.gTracker.createActionEvent("SourceCodeBrowser","Download","Copy","SourceCode",n)}function t(n){$(".sourceListTabs > div").removeClass("selectedLanguage").addClass("unselectedLanguage"),$(n).removeClass("unselectedLanguage").addClass("selectedLanguage");var t=$(n).attr("id")+"_Content";$(".sourceListContent").children("div").hide(),$("#"+t).show()}function u(n){var t=$(n).next();$(n).children("div:first").toggleClass("sbfc").toggleClass("sbfe"),t.css("display")=="block"?t.css("display","none"):t.css("display","block")}function s(n){var t=$(n).next();$(n).children("div:first").removeClass("sbfc").addClass("sbfe"),t.css("display","block")}function r(t,r){var u=$(t).data("fileid"),o=$(t).data("pathid"),s=$(t).data("name"),f,e;return t&&$(t).children("div:first").hasClass("sbsf")?!1:($("div.sourceList div.sbsf").removeClass("sbsf"),t&&($(t).children("div:first").addClass("sbsf"),t.focus()),$("div#sourceItem").load(n.fileUrl.replace(/fileIdHolder/,u).replace(/pathIdHolder/,o),null,function(){i&&i(u)}),document.title=s,window.history&&window.history.pushState&&r&&(f=$(t).attr("href"),e={title:document.title,fileId:u,pathId:o},window.history.pushState(e,null,f)),!1)}function o(n){var i=n.originalEvent.state,u,f;i&&(document.title=i.title,i.fileId&&i.pathId?(u=$(".sourceList a[data-fileid="+i.fileId+"][data-pathid="+i.pathId+"]"),r(u.get(0)),f=$(u).parents(".langContent").attr("id").replace("_Content",""),t($("#"+f))):($("div#sourceItem").empty(),$(".browseFile *").removeClass("sbsf"),t($(".sourceListTabs > div:first"))))}var n;return{init:e}}(),Galleries.project=function(){function u(){f("longdescIframe","longDesc")}function f(n,t){var r=$("#"+n),i=$("#"+n).contents();i.length>0&&i[0].documentElement!=null&&(longDesc=i.find("#"+t),longDesc.length>0&&longDesc.is(":visible")&&r.height()!==longDesc.height()&&r.height(longDesc.height()+20))}function e(n){var i=$(n).attr("toggleText"),t=$(n).text();$(n).text(i),$(n).attr("toggleText",t),$(n).toggleClass("openLink"),$(n).parents(".thread").find(".posts").slideToggle("normal"),$(n).parents(".thread").find(".postSaveReplyLocation").children("#postReplyDiv").hide()}function t(t,i,r){(!r||typeof this.customPromptFunction=="function"&&this.customPromptFunction(t,i,r)||typeof this.customPromptFunction!="function"&&confirm(r))&&n(t,i);return}function i(n){this.customPromptFunction=n}function n(n,t){$.post(n,{__RequestVerificationToken:$("#forgeryForm > input").val()},function(){typeof t=="string"?window.location=t:window.location.reload()})}function r(){var n=$("#authorProjectContainer").data("url");n&&$.ajax({url:n}).done(function(n){$("#authorProjectContainer").html(n)})}var o;return{resizeDesc:u,toggleThread:e,manageItem:t,configureManage:i,performManage:n,getAuthorProjects:r}}(),Galleries.cookie=function(){function i(n,t,i,r,u,f){document.cookie=n+"="+escape(t)+(i?"; expires="+i.toUTCString():"")+(r?"; path="+r:"")+(u?"; domain="+u:"")+(f?"; secure":"")}function n(n){var i=document.cookie.indexOf(n+"="),r=i+n.length+1,t;return!i&&n!==document.cookie.substring(0,n.length)?null:i===-1?null:(t=document.cookie.indexOf(";",r),t===-1&&(t=document.cookie.length),unescape(document.cookie.substring(r,t)))}function t(){var f=new Date,u=f.getTimezoneOffset()/-60,r=n("TimezoneOffset"),t;(r==null||r!==u)&&(t=new Date,t.setDate(t.getDate()+7),i("TimezoneOffset",u,t,"/"))}return{setTimezoneOffsetCookie:t}}(),Galleries.form=function(){function t(t,i){return n(t,i)}function n(n,t,i,r){var n=$(n),u=t?$("#"+t):null,f=n.serializeArray();return $.ajax({type:n.attr("method"),url:n.attr("action"),data:f,success:function(t,r,f){u&&u.length>0&&u.html(t),i&&i.call(n.get(0),t,r,f)},error:function(t){r&&r(n.get(0),t)}}),!1}return{submitAsync:t,submitAsyncWithCallback:n}}(),Galleries.url=function(){function i(n,t,i){var r=$("#"+t);return $.ajax({type:"POST",url:n,success:function(n){r.length>0&&r.html(n),i(n)}}),!1}function t(n,t){if(typeof s!="undefined"&&s!=null){var r=s.pageName,i=s.prop3;s.pageName+="_"+n,s.prop3+="_"+n,s.t(),s.pageName=r,s.prop3=i}t&&$.post(t)}function n(n,t,i,r){typeof t_omni_utils!="undefined"&&t_omni_utils&&t_omni_utils.omniModTracking&&t_omni_utils.omniModTracking(!0,n,"",t,i,r)}return{postAsyncWithCallback:i,recordAdditionalPageView:t,trackCustomClick:n}}(),Galleries.utility=function(){function t(n){var t=document.createElement("script"),i;t.type="text/javascript",t.async=!0,t.src=n,i=document.getElementsByTagName("head")[0],i.appendChild(t)}function i(n,i){i?$(window).load(function(){t(n)}):t(n)}function n(t,i){t()?i():setTimeout(function(){n(t,i)},100)}return{loadJavaScript:i,waitFor:n}}(),Galleries.searchIntellisense=function(){function r(n,i,r,u,f,e){return n.length>0&i.length>0?n+"?"+t(i,r,u,f,e)+"&paramsCallback=Galleries.searchIntellisense.getCallbackParams":""}function t(n,t,i,r,u){return"appid="+n+"&scopeid=1&boxId="+t+"&btnId="+i+"&watermark="+encodeURIComponent(r)+"&overrideWatermark=true&searchLocation="+encodeURIComponent(u)+"&allowEmptySearch=true&focusOnInit=false&minimumTermLength=4"}function n(){var t="",r=$("#"+currentSearchContainerId+" input[type='text']"),n;for(t+="&"+encodeURIComponent($(r[0]).attr("name"))+"="+encodeURIComponent($(r[0]).attr("value")),n=$("#"+currentSearchContainerId+" input[type='hidden'].filter"),i=0;i<n.length;i++)t+="&"+encodeURIComponent($(n[i]).attr("name"))+"="+encodeURIComponent($(n[i]).attr("value"));return t}return{getUrl:r,getCallbackParams:n}}(),Galleries.Library=function(){var i=function(){return $("#richDescription iframe").contents()},r=function(r){var f=i(),e,u,o;f.length>0&&(e=$("head",f),e.find('link[href*="'+r+'"]').length==0&&(u=document.createElement("link"),u.rel="stylesheet",u.type="text/css",u.href=r,e.append(u))),o=$("body",f),$("#richDescription tr.mceFirst").attr("style","display:none"),o.attr("contenteditable","false"),t(f,!1),n(!1)},u=function(){var t=$("#LibraryUrlInput"),u=$("#libraryContentError");t.val()&&$.ajax({url:"/site/library/description?url="+t.val()}).done(function(f){var s=i();if(s.length>0){var e=$("body",s),o=$("#LibraryPublishDate"),c=$("#LibraryShortId"),h=$("#LibraryUrl");f.Error?(u.html(f.Error),o.val(""),e.html("")):(u.html(""),r(f.DescriptionCSS),e.html(f.Content),e.trigger("click"),n(!1),h.val(t.val()),o.val(f.PublishDate),c.val(f.ShortId))}})},f=function(r){var u=i(),e=$("body",u),f;u.length>0&&(f=$("#libraryContainer"),r==="LibrarySample_Tab"?(f.attr("style","display:block"),$("#richDescription tr.mceFirst").attr("style","display:none"),e.attr("contenteditable","false"),t(u,!1),n(!1)):(f.attr("style","display:none"),$("#richDescription tr.mceFirst").attr("style","display:block"),n(!0),e.attr("contenteditable","true"),t(u,!0),$("head",u).remove("libDescCss")))},n=function(n){$("#descriptionProgressMeter .pluginHolder").attr("style","display:"+(n?"block":"none"))},t=function(n,t){if($.browser.mozilla&&n&&n.length>0){var i=t?"on":"off";n.get(0).designMode=i}};return{setContent:u,toggle:f,addCss:r}}(),StreamEvents={},StreamEvents.tracker=function(){function n(n,r){var u=$.extend(t,n?n:{}),f=$.extend(i,r?r:{});return u.init(f),u}var i={beaconUrl:null,pageEventType:"Page",pageActionEventType:"PageAction",pageEventArg:null},t={option:null,init:function(n){this.option=n},createActionEvent:function(n,t,i,r,u){var f=$.extend({},this.option.pageEventArg,{Section:n,ActionType:t,Action:i,ActionContentType:r,ActionContent:u});this.createEvent(this.option.pageActionEventType,f)},createEvent:function(n,t){var i=this.option.beaconUrl+"?Type="+escape(n)+"&"+$.param(t)+"&U="+escape(+new Date);$("<img />").attr("src",i)}};return{create:n}}(),fileManagerMethods=function(){this.baseInit=function(n,t,i,r,u,f,e,o,s){this.activeFileId=null,this.update=null,this.activeElem=null,this.fileContainer=i,this.projectName=t,this.uploadFileLimit=o,this.uploadUrl=u,this.removeUrl=f,this.parseUrl=e,this.localizedStrings=r,this.spanEditLabelElem=$("span.addLabel",n),this.iFrameElem=$("iframe",n),this.container=n,this.addedContainer=$(".addedFiles",n),this.progressContainer=$(".fileUploadProgressIndicator",n),this.errorContainer=$(".errors",n),this.uploadControl=$("#uploadControl",n);var h=this;this.inputCancelElem=$('<a data-command="cancel">'+this.localizedStrings.cancelLink+"</a>").click(function(n){h.handleAction(n)}).insertAfter(this.spanEditLabelElem).hide(),this.requirementsUrl=s&&s.requirementsUrl,this.hideVsVersion=s&&s.hideVsVersion,this.iFrameElem[0].fileManager=this,this.resetFileInput()},this.loadFiles=function(n){var t=this;$.each(n,function(n,i){t.itemHandler(i,!0)})},this.resetIFrame=function(){this.iFrameElem.attr("src",this.uploadUrl)},this.adjustIFrame=function(n){n?this.iFrameElem.removeClass("uploadControlWithError").addClass("uploadControlNoError"):this.iFrameElem.removeClass("uploadControlNoError").addClass("uploadControlWithError")},this.hideUploadControl=function(){this.uploadControl.hide()},this.resetUploadControl=function(){this.inputCancelElem.hide(),this.uploadControl.parent().get(0)!=this.container.get(0)&&this.container.append(this.uploadControl),this.uploadControl.show()},this.shouldAllowMoreUploads=function(){var n=$(".file",this.addedContainer).length;return this.uploadFileLimit===null||n<this.uploadFileLimit},this.setUploadControlLabel=function(){$(".file",this.addedContainer).length>0?this.spanEditLabelElem.text(this.localizedStrings.addLabel):this.spanEditLabelElem.text("")},this.resetFileInput=function(){this.shouldAllowMoreUploads()?(this.setUploadControlLabel(),this.resetIFrame(),this.resetUploadControl()):this.hideUploadControl(),this.progressContainer.hide(),this.activeFileId=null,this.activeElem=null},this.handleEdit=function(n,t){this.activeElem!==n&&(this.activeFileId=t.fileId,this.activeElem=n,this.inputCancelElem.show(),this.uploadControl.show(),this.spanEditLabelElem.html(this.localizedStrings.editLabel+" "+t.name),this.resetIFrame(),$(".file .information",this.container).show(),$(".uploadPlaceholder",this.activeElem).append(this.uploadControl),$(".information",this.activeElem).hide())},this.handleCancel=function(){this.resetFileInput(),$(".information",this.activeElem).show()},this.handleRemove=function(n,t){var i=this,r=function(){n.remove(),i.resetFileInput(),i.fileContainer.removeFileFromFileContainer(t.fileId),i.afterRemove(n,t)};i.removeUrl?$.ajax({url:i.removeUrl,data:{fileId:t.fileId,formId:i.projectName},type:"delete",success:function(){r()}}):r()},this.afterRemove=function(){},this.handleRequirementBrowse=function(n,t){var i=this;i.fetchingBrowseData||(i.fetchingBrowseData=!0,$.get("/site/requirements/browse?fileid="+t.fileId,function(r){$.prompt(r,{prefix:"reqBrowse",top:"10px",buttons:{Add:!0,Cancel:!1},submit:function(r){if(r){var e=i.getRequirementContainer(n);$(".reqBrowsecontainer input[type=checkbox]:checked").each(function(){if(RequirementsBrowse&&RequirementsBrowse.Data){var r=RequirementsBrowse.Data[$(this).attr("name")],u=$("input[projectName='"+r.Name+"']",e);u.length<=0&&($("label",e).remove(),e.append(i.createRequirementElement(t.fileId,r.Name,r.Title,r.Link,r.FileLink,r.VsixId,0,e,!0)),i.setDirtyBitAsHiddenElement(t.fileId,e))}})}},callback:function(){i.fetchingBrowseData=!1}})}))},this.handleRequirementAdd=function(n,t){var u=this,f=this.getRequirementContainer(n),i=$(".requirementsAdd input[type=text]",n),e=$(".requirementsAdd a",n),r;f&&i.length>0&&i.val()&&!i.get().disabled&&(i.get().disabled=1,r=u.getProjectUrl(i.val()),this.getProjectData(this.requirementsUrl+r,function(n){u.requirementsAddCallback(n,f,i,t)}))},this.requirementsAddCallback=function(n,t,i,r){var e,u,f;n&&n.Name&&n.Title&&n.Link?($("label",t).remove(),$(".requirementsAddError",i.parent()).remove(),e=$("input[projectName='"+n.Name+"']",t),e.length<=0&&(u=null,n.Files&&n.Files.length>0&&n.Files[0].Link&&(u=n.Files[0].Link),t.append(this.createRequirementElement(r.fileId,n.Name,n.Title,n.Link,u,n.VsixId,0,t,!0)),this.setDirtyBitAsHiddenElement(r.fileId,t),i.get().disabled=0,i.val("").focus())):(f=$(".requirementsAddError",i.parent()),f.html(this.localizedStrings.requirementsAddError))},this.createRequirementElement=function(n,t,i,r,u,f,e,o,s){var v=this,l=$("<div/>"),h=$("<a/>"),c,a;return h.attr("target","_blank"),h.attr("href",encodeURI(r)),s?h.html($("<div/>").text(i).html()):h.html(i),l.append(h),e||(c=$("<a/>"),c.click(function(){l.remove(),v.setDirtyBitAsHiddenElement(n,o)}),c.addClass("requirementsRemove"),c.html(this.localizedStrings.requirementsRemove),l.append(c)),a=t+"|"+i+"|"+h.attr("href")+"|"+f,u&&(a+="|"+u),$("<input>").attr("type","hidden").attr("projectName",t).attr("name",n).attr("value",a).appendTo(l),l},this.getRequirementContainer=function(n){return $(".requirementsContent",n)},this.setDirtyBitAsHiddenElement=function(n,t){var i=$("input[reqdirty='1']",t);i.length<=0&&$("<input>").attr("type","hidden").attr("reqdirty","1").attr("name",n+"-dirty").attr("value","1").appendTo(t)},this.getProjectUrl=function(n){return n=n.substring(0,n.indexOf("#")==-1?n.length:n.indexOf("#")),n=n.substring(0,n.indexOf("?")==-1?n.length:n.indexOf("?")),n=n.substring(n.lastIndexOf("/")+1,n.length)},this.getProjectData=function(n,t){var i=this;$.ajax({url:n,dataType:"jsonp",success:function(n){t.apply(i,[n])},error:function(n){t.apply(i,[n])}})},this.actions={edit:this.handleEdit,cancel:this.handleCancel,remove:this.handleRemove,requirementAdd:this.handleRequirementAdd},this.handleAction=function(n,t,i){var u=$(n.currentTarget),f=u.data("command"),r=this.actions[f];r&&r.call(this,t||u,i)},this.createManageLinksElement=function(){return"<span class='manageLinks'><a data-command=\"edit\">"+this.localizedStrings.editLink+'</a> | <a data-command="remove">'+this.localizedStrings.removeLink+"</a></span>"},this.createAddedElement=function(n,t){var c=this.localizedStrings,nt="<div class='file "+(t||"")+"'>",g="<div class='title'>",it="<div class='uploadPlaceholder'></div>",tt="<label>"+n.name+"</label>",ut=this.createManageLinksElement(t),rt="</div>",et=g+ut+tt+rt,ft="<div class='information'>",p="",w="",o=[],a=n.disableChangeRequirement,i=null,y,f,l,e,s,u,h;if(t!="translated"&&(o.push("<div class='requirements'><label>",c.requirementsTitle,"</label><div class='requirementsContent'>"),i=n.requirements,(!i||i&&i.length<=0)&&!a&&o.push("<label>",c.requirementsMessage,"</label>"),a||o.push("</div><div class='requirementsAdd'><input type='text' class='requirementsInput' data-command=\"requirementAdd\"></input>",'<a data-command="requirementAdd">',c.requirementsAdd,"</a>","<input class='reqBrowseButton' type='button' value='",c.requirementsBrowse,"'>","<div class='requirementsAddError'></div></div></div>")),n.parseResult){if(!this.hideVsVersion&&n.parseResult.VisualStudioVersionName){var b="<div class='version'>",ot="<label>"+this.localizedStrings.visualStudioVersionLabel+"</label>",ct="<span>"+n.parseResult.VisualStudioVersionName+"</span>",lt="</div>";w=b+ot+ct+lt}if(n.parseResult.PrimaryLanguageStrings){var v="",st="<div class='language'>",ht="<label>"+this.localizedStrings.languageLabel+"</label>";$.each(n.parseResult.PrimaryLanguageStrings,function(n,t){v+="<div>"+t+"</div>"}),y="</div>",p=st+ht+v+y+o.join("")}}var d="</div>",k="</div>",r=$(nt+et+it+ft+w+p+d+k);if(r.data("fileId",n.fileId),r.data("type",t),f=this.getRequirementContainer(r),l=$(".requirementsAdd input[type=text]",r),l.length>0&&l.keypress(function(t){t.which==13&&(t.preventDefault(),h.handleAction(t,r,n))}),f.length>0&&(n.dirtyRequirements&&this.setDirtyBitAsHiddenElement(n.fileId,f),i)){if(n.errors&&n.errors.length>0){for(e=[],s=0;s<n.errors.length;s++)e.push("<div class='field-validation-error'>"),e.push(n.errors[s]),e.push("</div>");f.append(e.join(""))}for(u=0;u<i.length;u++)f.append(this.createRequirementElement(n.fileId,i[u].ProjectName,i[u].ProjectTitle,i[u].ProjectLink,i[u].FileLink,i[u].VsixId,a,f))}return h=this,$("a",r).click(function(t){h.handleAction(t,r,n)}),$("input[type=button].reqBrowseButton",r).click(function(){h.handleRequirementBrowse(r,n)}),r},this.showUploadProgress=function(){var n=this;return function(){function t(){var r="<div class='throbber'>",i=n.localizedStrings.uploadProgressText,t="</div>";return $(r+i+t)}$(".throbber",n.progressContainer).length==0&&n.progressContainer.append(t()),n.progressContainer.show()}},this.getFileUploadHandler=function(n){var t=this;return function(i){i.isValid?t.fileHandler(i,!1,n):(t.adjustIFrame(i.isValid),t.progressContainer.hide())}},this.fileHandler=function(n,t,i){if(t&&this.parseUrl){this.errorContainer.children().remove();var r=this;$.get(this.parseUrl,{fileId:n.fileId,uniqueKey:+new Date},function(t){t.Errors.length<=0?(n.parseResult=t,r.itemHandler(n,i)):$.each(t.Errors,function(n,t){r.errorContainer.append("<span class='field-validation-error'>"+t+"</span>")})})}else this.itemHandler(n,i)},this.itemHandler=function(n,t){this.activeElem?(this.resetUploadControl(),this.activeElem.replaceWith(this.createAddedElement(n,t)),this.fileContainer.removeFileFromFileContainer(n.fileId)):this.addedContainer.append(this.createAddedElement(n,t)),this.fileContainer.addFileToFileContainer(n.fileId,"Payload"),this.resetFileInput()},this.getUploadFormParameters=function(){var n=this;return function(){return{formId:n.projectName,existingFileId:n.activeFileId,fileIds:n.fileContainer.getFilesFromContainer("Payload")}}}},localizationManagerMethods=function(){var n="translated",i="generated",t="untranslated";this.init=function(){this.unlocalizedContainer=$(".unlocalizedFiles",this.container),this.defaultSampleSection=$("#defaultSampleSection",this.container),this.localizedSampleSection=$("#localizedSampleSection",this.container)},this.loadFiles=function(r){var f,u;this.localizedToParentMap={},this.generatedCount=0,this.parentMap={},this.localizableFiles=r;for(f in r)u=r[f],u.localizedFile?(u.localizedFile.generated&&this.generatedCount++,this.localizedToParentMap[u.localizedFile.fileId]=u.parentFile,this.itemHandler(u.localizedFile,u.localizedFile.generated?i:n)):(this.parentMap[u.parentFile.fileId]=u.parentFile,this.itemHandler(u.parentFile,t))},this.createManageLinksElement=function(r){return r===n?"<span class='manageLinks'><a data-command=\"edit\">"+this.localizedStrings.editLink+'</a> | <a data-command="remove">'+this.localizedStrings.removeLink+"</a></span>":r===t||r===i?"<span class='manageLinks'><a data-command=\"edit\">"+this.localizedStrings.translateLink+"</a></span>":void 0},this.getFileTranslateHandler=function(){return this.getFileUploadHandler(n)},this.resetUploadControl=function(){this.inputCancelElem.hide(),this.uploadControl.hide(),this.uploadControl.parent().get(0)!=this.container.get(0)&&this.container.append(this.uploadControl)},this.setUploadControlLabel=function(){},this.getUploadFormParameters=function(){var t=this;return function(){if(!t.activeElem)return{formId:null,existingFileId:null};var r={fileId:t.activeFileId};return(t.activeElem.data("type")==n||t.activeElem.data("type")==i)&&(r=t.localizedToParentMap[t.activeFileId]),{formId:t.projectName,existingFileId:r.fileId}}},this.resetIFrame=function(){this.activeElem&&this.iFrameElem.attr("src",this.uploadUrl)},this.afterRemove=function(n,i){var r=this.localizedToParentMap[i.fileId];delete this.localizedToParentMap[i.fileId],this.itemHandler(r,t)},this.showEmptyTranslationLabels=function(){var n=0,t;for(t in this.localizedToParentMap)this.localizedToParentMap.hasOwnProperty(t)&&++n;n<=0?(this.defaultSampleSection.show(),this.localizedSampleSection.hide()):n-this.generatedCount==this.localizableFiles.length?(this.defaultSampleSection.hide(),this.localizedSampleSection.show()):(this.defaultSampleSection.show(),this.localizedSampleSection.show())},this.itemHandler=function(t,i){var f,u,r;this.activeElem?(this.resetUploadControl(),f=this.activeElem.data("type"),f===n?this.activeElem.replaceWith(this.createAddedElement(t,i)):(u=this.activeElem.data("fileId"),this.localizedToParentMap[t.fileId]=this.parentMap[u],this.addedContainer.append(this.createAddedElement(t,i)),this.activeElem.remove())):(r=i===n?this.addedContainer:this.unlocalizedContainer,r.append(this.createAddedElement(t,i))),this.resetFileInput(),this.showEmptyTranslationLabels()}},Galleries.upload.createFileManager=createFileManager,Galleries.upload.createLocalizationFileManager=createLocalizationFileManager,function(n){n.fn.autocomplete=function(t,i){return this.each(function(){new n.autocomplete(this,t,i)})},n.autocomplete=function(t,i,r){this.settings={tagMode:"multiple",enterKeyCallback:null,watermark:null},$.extend(this.settings,r),this.input=n(t),this.wsUrl=i,this.results=n('<div style="position:absolute;z-index:100;display:none;width:300px;"></div>').addClass("AutoCompletePanel").hide(),this.isVisible=!1,this.selectedIndex=-1,this.data=[],this.delay=null,this.cancel=!1,this.init()},n.autocomplete.fn=n.autocomplete.prototype={},n.autocomplete.fn.extend=n.autocomplete.extend=n.extend,n.autocomplete.fn.extend({init:function(){var t=this;this.input.bind("keyup",function(n){t.handleKeyUp(n)}).bind("keydown",function(n){t.handleKeyDown(n)}).bind("keypress",function(n){t.handleKeyPress(n)}).bind("focus",function(n){t.handleFocus(n)}).bind("blur",function(n){t.handleBlur(n)}),this.settings.watermark&&this.input.watermark(this.settings.watermark),n(window).bind("resize",function(){t.reposition()}),this.results.appendTo("body")},handleKeyUp:function(n){n||(n=window.event);switch(n.keyCode){case 38:this.handleUpArrowKey();return;case 40:this.handleDownArrowKey();return;case 13:return}if(n.keyCode==9||this.input.val().length==0)this.reset();else{this.delay!=null&&(clearTimeout(this.delay),this.delay=null);var t=this;this.delay=setTimeout(function(){(t.delay=null,t.cancel)||$.post(t.wsUrl,{currentTags:t.input.val()},function(n){t.dataCallback(n,t)},"json")},150)}},handleKeyDown:function(n){n||(n=window.event);switch(n.keyCode){case 9:if(this.selectedIndex!=-1)return this.handleTabKey(),this.preventFurtherAction(n),!1;break;case 13:this.isVisible&&this.selectedIndex>-1?(this.handleEnterKey(),this.preventFurtherAction(n)):this.settings.enterKeyCallback&&(this.settings.enterKeyCallback(this.input.val()),this.preventFurtherAction(n))}return!0},handleKeyPress:function(n){return n||(n=window.event),n.keyCode==13&&this.isVisible?this.preventFurtherAction(n):void 0},handleUpArrowKey:function(){this.selectedIndex>0&&this.selectedIndex--,this.updateSelectedStyles()},handleDownArrowKey:function(){this.selectedIndex<this.results.children().length-1&&this.selectedIndex++,this.updateSelectedStyles()},handleTabKey:function(){this.selectTag()},handleFocus:function(){this.reset()},handleBlur:function(){this.reset(),this.cancel=!0},handleEnterKey:function(){this.selectTag(n.browser.mozilla)},handleMouseOver:function(t){var i=n(t.target);i.hasClass("Row")||(i=i.parent()),t.data.selectedIndex=i.attr("index"),t.data.updateSelectedStyles()},handleMouseDown:function(t){var i=n(t.target);i.hasClass("Row")||(i=i.parent()),t.data.selectTag(!1)},reset:function(){this.data=[],this.selectedIndex=-1,this.results.hide(),this.isVisible=!1,this.cancel=!1},dataCallback:function(n,t){t.cancel||(t.data=n?n:[],t.data.length>0?(t.dataBind(),t.reposition(),t.results.show(),t.isVisible=!0):t.reset())},dataBind:function(){var t,r,i;if(this.results.empty(),this.data.length>0)for(t=0;t<this.data.length;t++){r=this.data[t],i=r.Count,i+=i>1?" usages":" usage";var u=this._bindMouseEvents(n("<div></div>").addClass("Row").attr("index",t).appendTo(this.results)),e=this._bindMouseEvents(n("<div></div>").text(i).css("float","right").appendTo(u)),f=this._bindMouseEvents(n("<span></span>").text(r.Name).appendTo(u))}},_bindMouseEvents:function(n){var t=this;return n.bind("mouseover",t,t.handleMouseOver).bind("mousedown",t,t.handleMouseDown)},selectTag:function(n){var i,t;this.data!=null&&(i=this.data[this.selectedIndex],i&&(t=this.input.val(),t=t.indexOf(",")>0&&this.settings.tagMode==="multiple"?t.substr(0,t.lastIndexOf(","))+", "+i.Name:i.Name,this.input.val(t),n||this.reset(),this.input.focus()))},updateSelectedStyles:function(){var n=this;this.results.children().each(function(){$(this).attr("index")==n.selectedIndex?$(this).addClass("Selected"):$(this).removeClass("Selected")})},preventFurtherAction:function(n){var t=n.rawEvent?n.rawEvent:n;return t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),this.reset(),!1},encodeHTML:function(n,t){var i=document.createElement("div");return i.appendChild(document.createTextNode(n)),(t?i.innerHTML.split('"').join("&quot;"):i.innerHTML).split(" ").join("&nbsp;")},reposition:function(){var n=this.input.offset();this.results.css("left",n.left).css("top",n.top+this.input.outerHeight()).css("width",this.input.width())}})}(jQuery)